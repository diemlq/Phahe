<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Pháº£ há»‡ dáº¡ng trÃªnâ€“xuá»‘ng</title>
<script src="https://balkan.app/js/OrgChart.js"></script>
<style>
  html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden; /* Cháº·n cuá»™n trang web chÃ­nh, chá»‰ cuá»™n chart */
    font-family: Arial, sans-serif;
  }

  /* Viá»n cam bao quanh toÃ n bá»™ trang web */
  body {
    box-sizing: border-box;
    border: 6px solid #ff6a00;
    background: white;
  }

  #tree {
    width: 100%;
    height: 100%;
  }

  .node-text {
    width: 230px;
    text-align: center;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.1;
  }

  .index { font-size: 13px; color: #e60000; }
  .name { font-size: 15px; font-weight: normal; color: #fceb07; }
  .vc { font-size: 14px; color: #ffffff; }

  /* Há»™p chi tiáº¿t (popup) chung */
  #popup {
    display: none;
    position: absolute; /* Máº·c Ä‘á»‹nh cho PC */
    background: rgba(255,255,255,0.98);
    border: 2px solid #ff6a00;
    border-radius: 8px;
    padding: 15px;
    max-width: 300px;
    min-width: 200px;
    font-size: 14px;
    line-height: 1.4;
    z-index: 9999;
    box-shadow: 0 5px 15px rgba(0,0,0,0.4);
    color: #333;
  }

  /* NÃºt Ä‘Ã³ng popup (chá»‰ hiá»‡n rÃµ trÃªn mobile hoáº·c khi cáº§n) */
  .close-btn {
    display: block;
    margin-top: 10px;
    text-align: right;
    color: #039BE5;
    cursor: pointer;
    font-weight: bold;
    border-top: 1px solid #eee;
    padding-top: 5px;
  }

  /* CSS riÃªng cho Äiá»‡n thoáº¡i (MÃ n hÃ¬nh nhá» hÆ¡n 768px) */
  @media (max-width: 768px) {
    #popup {
      position: fixed; /* Cá»‘ Ä‘á»‹nh trÃªn mÃ n hÃ¬nh */
      top: 50% !important;
      left: 50% !important;
      transform: translate(-50%, -50%); /* CÄƒn giá»¯a tuyá»‡t Ä‘á»‘i */
      width: 80%; /* Chiá»u rá»™ng chiáº¿m 80% mÃ n hÃ¬nh */
      max-width: 90%;
    }
    
    /* LÃ m má» ná»n khi popup hiá»‡n trÃªn mobile (tÃ¹y chá»n) */
    #popup::before {
      content: '';
      position: fixed;
      top: -1000px; left: -1000px; right: -1000px; bottom: -1000px;
      z-index: -1;
      /* background: rgba(0,0,0,0.1); */
    }
  }

  .announcement-bar {
    font-family: 'Lobster', cursive; 
    text-align: center; 
    font-size: 24px; /* Giáº£m font chá»¯ xÃ­u cho mobile Ä‘á»¡ vá»¡ */
    padding: 10px 0; 
    color: #d14b00;
  }
</style>
<link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
</head>
<body>

<div class="announcement-bar"> ğŸ”¥ Gia Ä‘Ã¬nh cá»¥ Nguyá»…n ÄÃ¬nh A ğŸ”¥ </div>  
<div id="tree"></div>

<div id="popup">
  <div id="popup-content"></div>
  <div class="close-btn" onclick="document.getElementById('popup').style.display='none'">ÄÃ³ng X</div>
</div>

<script>
var nodes = [
  { id: 1, index: "Äá»i thá»© 1", name: "Nguyá»…n ÄÃ¬nh A: 1844", VC: "Äá»— Thá»‹ A", chitiet: "NgÆ°á»i sÃ¡ng láº­p chi há», sinh nÄƒm 1844, quÃª HÃ  TÃ¢y." },
  { id: 2, pid: 1, index: "Äá»i thá»© 2", name: "Nguyá»…n ÄÃ¬nh B: 1882", VC: "Äá»— Thá»‹ B", chitiet: "Con trÆ°á»Ÿng cá»§a Nguyá»…n ÄÃ¬nh A, cÃ³ nhiá»u Ä‘Ã³ng gÃ³p cho dÃ²ng há»." },
  { id: 3, pid: 2, index: "Äá»i thá»© 3", name: "Nguyá»…n ÄÃ¬nh C: 1912", VC: "Nguyá»…n Thá»‹ C", chitiet: "CÃ´ng tÃ¡c trong ngÃ nh giÃ¡o dá»¥c, cÃ³ ba ngÆ°á»i con." },
  { id: 4, pid: 2, index: "Äá»i thá»© 3", name: "Nguyá»…n ÄÃ¬nh D: 1914", VC: "Nguyá»…n Thá»‹ D: 1922", chitiet: "Sinh nÄƒm 1914, lÃ m viá»‡c táº¡i HÃ  Ná»™i, cÃ³ hai ngÆ°á»i con." },
  { id: 7, pid: 3, index: "Äá»i thá»© 4", name: "Nguyá»…n ÄÃ¬nh E: 1940", VC: "Nguyá»…n Thá»‹ E", chitiet: "Ká»¹ sÆ° Ä‘iá»‡n, tá»«ng cÃ´ng tÃ¡c táº¡i nhÃ  mÃ¡y thá»§y Ä‘iá»‡n HÃ²a BÃ¬nh." },
  { id: 11, pid: 3, index: "Äá»i thá»© 4", name: "Nguyá»…n Thá»‹ G: 1955", VC: "Nguyá»…n Äá»©c G: 1946", chitiet: "Sinh nÄƒm 1955, hiá»‡n sinh sá»‘ng táº¡i Nam Äá»‹nh." },
  { id: 12, pid: 4, index: "Äá»i thá»© 4", name: "Nguyá»…n ÄÃ¬nh H", VC: "Nguyá»…n Thá»‹ H: 1954", chitiet: "GiÃ¡o viÃªn nghá»‰ hÆ°u<br> cÃ³ hai ngÆ°á»i con trai." },
  { id: 19, pid: 4, index: "Äá»i thá»© 4", name: "Nguyá»…n Thá»‹ K: 1947", VC: "Äá»— ThÃ¡i Kh: 1942", chitiet: "CÃ´ng tÃ¡c trong ngÃ nh y<br>cÃ³ con trai trÆ°á»Ÿng lÃ  Äá»— VÄƒn L." }
];

OrgChart.templates.centerAlign = Object.assign({}, OrgChart.templates.ana);
OrgChart.templates.centerAlign.size = [240, 70];
OrgChart.templates.centerAlign.minus =
  '<circle cx="15" cy="15" r="7" fill="#ffffff" stroke="#039BE5" stroke-width="1.2"></circle>' +
  '<path d="M10.5,15 h9" stroke="#039BE5" stroke-width="1.6"></path>';
OrgChart.templates.centerAlign.plus =
  '<circle cx="15" cy="15" r="7" fill="#ffffff" stroke="#039BE5" stroke-width="1.2"></circle>' +
  '<path d="M15,10.5 v9 M10.5,15 h9" stroke="#039BE5" stroke-width="1.6"></path>';
OrgChart.templates.centerAlign.link =
  '<path stroke="#808080" stroke-width="1" fill="none" d="{edge}" />';
OrgChart.templates.centerAlign.field_0 =
  '<foreignObject x="5" y="10" width="230" height="20"><div class="node-text index">{val}</div></foreignObject>';
OrgChart.templates.centerAlign.field_1 =
  '<foreignObject x="5" y="28" width="230" height="22"><div class="node-text name">{val}</div></foreignObject>';
OrgChart.templates.centerAlign.field_2 =
  '<foreignObject x="5" y="48" width="230" height="18"><div class="node-text vc">{val}</div></foreignObject>';

var chart = new OrgChart(document.getElementById("tree"), {
  template: "centerAlign",
  enableSearch: true,
  nodeMouseClick: OrgChart.action.none, // Quan trá»ng: Táº¯t hÃ nh Ä‘á»™ng máº·c Ä‘á»‹nh
  collapse: { level: 4 },
  nodes: nodes,
  nodeBinding: { field_0: "index", field_1: "name", field_2: "VC" }
});

const popup = document.getElementById("popup");
const popupContent = document.getElementById("popup-content");

// Xá»­ lÃ½ sá»± kiá»‡n CLICK (hoáº¡t Ä‘á»™ng cho cáº£ Click chuá»™t vÃ  Cháº¡m tay)
chart.on('click', function(sender, args){
  const node = chart.get(args.node.id);
  
  if (node && node.chitiet) {
    // 1. Äiá»n ná»™i dung
    popupContent.innerHTML = `
      <div style="font-size:16px; font-weight:bold; margin-bottom:5px; color:#d14b00;">${node.name}</div>
      <div style="color:#555;">${node.chitiet}</div>
    `;
    
    popup.style.display = "block";

    // 2. Xá»­ lÃ½ vá»‹ trÃ­
    // Kiá»ƒm tra xem Ä‘ang dÃ¹ng PC hay Mobile dá»±a vÃ o chiá»u rá»™ng mÃ n hÃ¬nh
    if (window.innerWidth <= 768) {
        // MOBILE: DÃ¹ng CSS 'fixed' vÃ  'center' Ä‘Ã£ Ä‘á»‹nh nghÄ©a trong style @media
        // Reset cÃ¡c giÃ¡ trá»‹ top/left cÅ© náº¿u cÃ³
        popup.style.position = "fixed";
        popup.style.top = "50%";
        popup.style.left = "50%";
    } else {
        // PC: Láº¥y tá»a Ä‘á»™ chuá»™t
        // LÆ°u Ã½: args.event trÃªn PC cÃ³ pageX/Y.
        popup.style.position = "absolute";
        popup.style.top = (args.event.pageY + 15) + "px";
        popup.style.left = (args.event.pageX + 15) + "px";
        
        // Logic nhá»: Náº¿u popup bá»‹ trÃ n ra ngoÃ i mÃ n hÃ¬nh bÃªn pháº£i thÃ¬ Ä‘áº©y sang trÃ¡i
        if (args.event.pageX + 300 > window.innerWidth) {
             popup.style.left = (args.event.pageX - 315) + "px";
        }
    }
  }
  return false; // NgÄƒn cháº·n hÃ nh Ä‘á»™ng máº·c Ä‘á»‹nh (zoom/expand node)
});

// Khi click ra ngoÃ i thÃ¬ áº©n popup
document.addEventListener('click', function(e){
  // Náº¿u click KHÃ”NG PHáº¢I vÃ o node VÃ€ KHÃ”NG PHáº¢I vÃ o popup thÃ¬ áº©n
  if (!e.target.closest('.node') && !e.target.closest('#popup')) {
    popup.style.display = 'none';
  }
}, true); // Use capture phase Ä‘á»ƒ báº¯t sá»± kiá»‡n tá»‘t hÆ¡n trÃªn mobile
</script>
</body>
</html>
