<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Ph·∫£ h·ªá d·∫°ng tr√™n‚Äìxu·ªëng</title>
<script src="https://balkan.app/js/OrgChart.js"></script>

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100vh;
    overflow: auto;
  }

  #tree {
    width: 100vw;
    height: 100vh;
  }

  .node-text {
    width: 230px;
    text-align: center;
    word-wrap: break-word;
    overflow-wrap: break-word;
    line-height: 1.1;
  }

  .index { font-size: 13px; color: #e60000; }
  .name { font-size: 15px; font-weight: normal; color: #fceb07; }
  .vc { font-size: 14px; color: #ffffff; }

  /* Popup chi ti·∫øt */
  #popup {
    position: absolute;
    background: rgba(255,255,255,0.97);
    border: 1px solid #666;
    border-radius: 8px;
    padding: 10px 14px;
    max-width: 300px;
    font-size: 14px;
    line-height: 1.3;
    display: none;
    z-index: 9999;
    box-shadow: 0 3px 12px rgba(0,0,0,0.3);
  }
</style>
</head>

<body>
<style>
  html {
    box-sizing: border-box;
    padding: 8px;
    background: #000;
    min-height: 100vh;
  }

  body {
    margin: 0;
    min-height: 100vh;
    border: 6px solid #ff6a00;
    border-radius: 12px;
    overflow-x: hidden;
    background: white;
  }
</style>

<!-- Font Lobster -->
<link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">

<style>
  .announcement-bar {
    font-family: 'Lobster', cursive;
    text-align: center;
    font-size: 32px;
    padding: 10px 0;
    color: #d14b00;
  }
</style>

<div class="announcement-bar">üî• Con ch√°u gia ƒë√¨nh c·ª• Nguy·ªÖn ƒê√¨nh A üî•</div>

<div id="tree"></div>
<div id="popup"></div>

<script>
/* ===== D·ªØ li·ªáu node ===== */
var nodes = [
  { id: 1, index: "ƒê·ªùi th·ª© 1", name: "Nguy·ªÖn ƒê√¨nh A: 1844", VC: "ƒê·ªó Th·ªã A", chitiet: "Ng∆∞·ªùi s√°ng l·∫≠p chi h·ªç, sinh nƒÉm 1844, qu√™ H√† T√¢y." },
  { id: 2, pid: 1, index: "ƒê·ªùi th·ª© 2", name: "Nguy·ªÖn ƒê√¨nh B: 1882", VC: "ƒê·ªó Th·ªã B", chitiet: "Con tr∆∞·ªüng c·ªßa Nguy·ªÖn ƒê√¨nh A, c√≥ nhi·ªÅu ƒë√≥ng g√≥p cho d√≤ng h·ªç." },
  { id: 3, pid: 2, index: "ƒê·ªùi th·ª© 3", name: "Nguy·ªÖn ƒê√¨nh C: 1912", VC: "Nguy·ªÖn Th·ªã C", chitiet: "C√¥ng t√°c trong ng√†nh gi√°o d·ª•c, c√≥ ba ng∆∞·ªùi con." },
  { id: 4, pid: 2, index: "ƒê·ªùi th·ª© 3", name: "Nguy·ªÖn ƒê√¨nh D: 1914", VC: "Nguy·ªÖn Th·ªã D: 1922", chitiet: "Sinh nƒÉm 1914, l√†m vi·ªác t·∫°i H√† N·ªôi, c√≥ hai ng∆∞·ªùi con." },
  { id: 7, pid: 3, index: "ƒê·ªùi th·ª© 4", name: "Nguy·ªÖn ƒê√¨nh E: 1940", VC: "Nguy·ªÖn Th·ªã E", chitiet: "K·ªπ s∆∞ ƒëi·ªán, t·ª´ng c√¥ng t√°c t·∫°i nh√† m√°y th·ªßy ƒëi·ªán H√≤a B√¨nh." },
  { id: 11, pid: 3, index: "ƒê·ªùi th·ª© 4", name: "Nguy·ªÖn Th·ªã G: 1955", VC: "Nguy·ªÖn ƒê·ª©c G: 1946", chitiet: "Sinh nƒÉm 1955, hi·ªán sinh s·ªëng t·∫°i Nam ƒê·ªãnh." },
  { id: 12, pid: 4, index: "ƒê·ªùi th·ª© 4", name: "Nguy·ªÖn ƒê√¨nh H", VC: "Nguy·ªÖn Th·ªã H: 1954", chitiet: "Gi√°o vi√™n ngh·ªâ h∆∞u<br>c√≥ hai ng∆∞·ªùi con trai." },
  { id: 19, pid: 4, index: "ƒê·ªùi th·ª© 4", name: "Nguy·ªÖn Th·ªã K: 1947", VC: "ƒê·ªó Th√°i Kh: 1942", chitiet: "C√¥ng t√°c trong ng√†nh y<br>c√≥ con trai tr∆∞·ªüng l√† ƒê·ªó VƒÉn L." }
];

/* ===== Template ===== */
OrgChart.templates.centerAlign = Object.assign({}, OrgChart.templates.ana);
OrgChart.templates.centerAlign.size = [240, 70];
OrgChart.templates.centerAlign.minus =
  '<circle cx="15" cy="15" r="7" fill="#ffffff" stroke="#039BE5" stroke-width="1.2"></circle>' +
  '<path d="M10.5,15 h9" stroke="#039BE5" stroke-width="1.6"></path>';
OrgChart.templates.centerAlign.plus =
  '<circle cx="15" cy="15" r="7" fill="#ffffff" stroke="#039BE5" stroke-width="1.2"></circle>' +
  '<path d="M15,10.5 v9 M10.5,15 h9" stroke="#039BE5" stroke-width="1.6"></path>';
OrgChart.templates.centerAlign.link =
  '<path stroke="#808080" stroke-width="1" fill="none" d="{edge}" />';
OrgChart.templates.centerAlign.field_0 =
  '<foreignObject x="5" y="10" width="230" height="20"><div class="node-text index">{val}</div></foreignObject>';
OrgChart.templates.centerAlign.field_1 =
  '<foreignObject x="5" y="28" width="230" height="22"><div class="node-text name">{val}</div></foreignObject>';
OrgChart.templates.centerAlign.field_2 =
  '<foreignObject x="5" y="48" width="230" height="18"><div class="node-text vc">{val}</div></foreignObject>';

/* ===== Kh·ªüi t·∫°o chart ===== */
var chart = new OrgChart(document.getElementById("tree"), {
  template: "centerAlign",
  enableSearch: true,
  nodeMouseClick: OrgChart.action.none,
  collapse: { level: 4 },
  nodes: nodes,
  nodeBinding: { field_0: "index", field_1: "name", field_2: "VC" }
});

/* ==========================================
   X·ª¨ L√ù CLICK MOBILE + PC
   ========================================== */

const popup = document.getElementById("popup");

function showPopup(node, x, y) {
  popup.innerHTML = `<b>${node.name}</b><br>${node.chitiet}`;
  popup.style.display = "block";
  popup.style.left = (x + 12) + "px";
  popup.style.top = (y + 12) + "px";
}

/* PC: click */
chart.on('nodeClick', function(sender, args){
  const node = chart.get(args.node.id);
  if (!node || !node.chitiet) return false;

  let e = args.event;
  showPopup(node, e.pageX, e.pageY);

  return false;
});

/* Mobile: tap */
chart.on('tap', function(sender, args){
  const node = chart.get(args.node.id);
  if (!node || !node.chitiet) return false;

  let e = args.event;
  let touch = e.touches?.[0] || e.changedTouches?.[0] || e;

  showPopup(node, touch.pageX, touch.pageY);

  return false;
});

/* ·∫®n popup khi b·∫•m ra ngo√†i */
document.addEventListener('click', function(e){
  if (!e.target.closest('.node') && !e.target.closest('#popup')) {
    popup.style.display = 'none';
  }
});
</script>

</body>
</html>
